# Generated by Django 4.2 on 2026-02-06 03:46

from django.conf import settings
import django.core.validators
from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='FinancialModel',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=255)),
                ('project_type', models.CharField(choices=[('manufacturing', 'Manufacturing'), ('real_estate', 'Real Estate'), ('energy', 'Energy & Power'), ('oil_gas', 'Oil & Gas'), ('healthcare', 'Healthcare'), ('technology', 'Technology'), ('agriculture', 'Agriculture'), ('infrastructure', 'Infrastructure'), ('general', 'General')], default='general', max_length=50)),
                ('status', models.CharField(choices=[('draft', 'Draft'), ('active', 'Active'), ('archived', 'Archived')], default='draft', max_length=20)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('last_calculated_at', models.DateTimeField(blank=True, null=True)),
                ('completion_percentage', models.IntegerField(default=0, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)])),
                ('is_calculation_in_progress', models.BooleanField(default=False)),
                ('calculation_error', models.TextField(blank=True, null=True)),
                ('owner', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='financial_models', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'ordering': ['-updated_at'],
            },
        ),
        migrations.CreateModel(
            name='Scenario',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=100)),
                ('scenario_type', models.CharField(choices=[('base', 'Base Case'), ('upside', 'Upside Case'), ('downside', 'Downside Case'), ('custom', 'Custom Scenario')], default='base', max_length=20)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('model', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='scenarios', to='model.financialmodel')),
            ],
            options={
                'ordering': ['scenario_type', 'name'],
                'unique_together': {('model', 'scenario_type')},
            },
        ),
        migrations.CreateModel(
            name='WorkingCapital',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('initial_wc_pct_year1_opex', models.DecimalField(decimal_places=2, max_digits=5)),
                ('receivables_days_dso', models.IntegerField()),
                ('inventory_days_dio', models.IntegerField()),
                ('payables_days_dpo', models.IntegerField()),
                ('wc_pct_revenue', models.DecimalField(decimal_places=2, max_digits=5)),
                ('minimum_cash_balance', models.DecimalField(decimal_places=2, max_digits=20)),
                ('wc_funding_source', models.CharField(default='From Equity', max_length=50)),
                ('wc_reserve_account', models.BooleanField(default=False)),
                ('scenario', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='working_capital', to='model.scenario')),
            ],
        ),
        migrations.CreateModel(
            name='TaxAssumptions',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('corporate_income_tax_rate', models.DecimalField(decimal_places=2, max_digits=5)),
                ('tax_holiday_years', models.IntegerField(default=0)),
                ('minimum_tax_rate', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('vat_sales_tax_rate', models.DecimalField(decimal_places=2, max_digits=5)),
                ('wht_dividends', models.DecimalField(decimal_places=2, max_digits=5)),
                ('wht_interest', models.DecimalField(decimal_places=2, max_digits=5)),
                ('wht_services', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('wht_rent', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('education_tax_pct', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('tax_loss_carryforward_years', models.IntegerField(default=5)),
                ('initial_allowance_pct', models.DecimalField(decimal_places=2, max_digits=5)),
                ('annual_allowance_pct', models.DecimalField(decimal_places=2, max_digits=5)),
                ('scenario', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='tax_assumptions', to='model.scenario')),
            ],
        ),
        migrations.CreateModel(
            name='ProjectInformation',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('project_name', models.CharField(max_length=255)),
                ('project_location', models.CharField(blank=True, max_length=255)),
                ('industry_sector', models.CharField(max_length=100)),
                ('project_type', models.CharField(max_length=50)),
                ('project_commencement_date', models.DateField()),
                ('construction_start_date', models.DateField()),
                ('construction_duration_months', models.IntegerField()),
                ('construction_end_date', models.DateField()),
                ('operations_start_date', models.DateField()),
                ('operations_duration_years', models.IntegerField()),
                ('total_capacity', models.DecimalField(blank=True, decimal_places=2, max_digits=20, null=True)),
                ('capacity_unit', models.CharField(blank=True, max_length=50)),
                ('maximum_plant_availability', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('availability_during_tam', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('commissioning_availability', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('factory_capacity_multiplier', models.DecimalField(blank=True, decimal_places=5, max_digits=10, null=True)),
                ('number_of_phases', models.IntegerField(default=1)),
                ('phase_1_capacity', models.DecimalField(blank=True, decimal_places=2, max_digits=20, null=True)),
                ('phase_2_capacity', models.DecimalField(blank=True, decimal_places=2, max_digits=20, null=True)),
                ('days_in_year', models.IntegerField(default=365)),
                ('hours_in_day', models.IntegerField(default=24)),
                ('scenario', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='project_info', to='model.scenario')),
            ],
        ),
        migrations.CreateModel(
            name='OperatingExpenses',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('raw_material_cost_per_unit', models.DecimalField(blank=True, decimal_places=2, max_digits=20, null=True)),
                ('raw_material_price_escalation', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('variable_cost_pct_revenue', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('fuel_gas_cost_per_mmbtu', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('total_headcount', models.IntegerField()),
                ('average_annual_salary', models.DecimalField(decimal_places=2, max_digits=15)),
                ('salary_escalation_rate', models.DecimalField(decimal_places=2, max_digits=5)),
                ('benefits_payroll_tax_pct', models.DecimalField(decimal_places=2, max_digits=5)),
                ('power_electricity_cost_annual', models.DecimalField(decimal_places=2, max_digits=20)),
                ('water_gas_utilities_annual', models.DecimalField(decimal_places=2, max_digits=20)),
                ('utilities_escalation_rate', models.DecimalField(decimal_places=2, max_digits=5)),
                ('property_management_pct', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('regular_maintenance_pct_revenue', models.DecimalField(decimal_places=2, max_digits=5)),
                ('insurance_annual', models.DecimalField(decimal_places=2, max_digits=20)),
                ('tam_cost', models.DecimalField(blank=True, decimal_places=2, max_digits=20, null=True)),
                ('tam_frequency_years', models.IntegerField(blank=True, null=True)),
                ('marketing_sales_pct_revenue', models.DecimalField(decimal_places=2, max_digits=5)),
                ('administrative_expenses_annual', models.DecimalField(decimal_places=2, max_digits=20)),
                ('rent_facilities_annual', models.DecimalField(decimal_places=2, max_digits=20)),
                ('technology_software_annual', models.DecimalField(decimal_places=2, max_digits=20)),
                ('professional_fees_annual', models.DecimalField(decimal_places=2, max_digits=20)),
                ('payables_days_dpo', models.IntegerField()),
                ('scenario', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='operating_expenses', to='model.scenario')),
            ],
        ),
        migrations.CreateModel(
            name='ModelTemplate',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=255, unique=True)),
                ('description', models.TextField(blank=True)),
                ('project_type', models.CharField(max_length=50)),
                ('is_public', models.BooleanField(default=False)),
                ('is_system_template', models.BooleanField(default=False)),
                ('template_data', models.JSONField()),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('created_by', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='created_templates', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='MacroAssumptions',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('reporting_currency', models.CharField(default='USD', max_length=10)),
                ('exchange_rate_local_per_usd', models.DecimalField(decimal_places=5, max_digits=15)),
                ('base_year', models.IntegerField()),
                ('periodicity', models.CharField(default='Annually', max_length=20)),
                ('number_of_years', models.IntegerField()),
                ('model_tolerance', models.DecimalField(decimal_places=5, default=0.001, max_digits=10)),
                ('local_inflation_rate', models.DecimalField(decimal_places=2, max_digits=5)),
                ('foreign_inflation_rate', models.DecimalField(decimal_places=2, max_digits=5)),
                ('longterm_target_inflation', models.DecimalField(decimal_places=2, max_digits=5)),
                ('revenue_opex_escalation_usd', models.DecimalField(decimal_places=2, max_digits=5)),
                ('discount_rate_wacc', models.DecimalField(decimal_places=2, max_digits=5)),
                ('risk_free_rate', models.DecimalField(decimal_places=2, max_digits=5)),
                ('benchmark_rate_type', models.CharField(default='SOFR', max_length=20)),
                ('benchmark_rate_value', models.DecimalField(decimal_places=2, max_digits=5)),
                ('terminal_growth_rate', models.DecimalField(decimal_places=2, max_digits=5)),
                ('contingency_buffer', models.DecimalField(decimal_places=2, max_digits=5)),
                ('scenario', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='macro_assumptions', to='model.scenario')),
            ],
        ),
        migrations.AddField(
            model_name='financialmodel',
            name='source_template',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='model.modeltemplate'),
        ),
        migrations.CreateModel(
            name='ExitValuation',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('exit_year', models.IntegerField()),
                ('exit_multiple_ev_ebitda', models.DecimalField(decimal_places=2, max_digits=5)),
                ('terminal_growth_rate_pct', models.DecimalField(decimal_places=2, max_digits=5)),
                ('discount_rate_npv_pct', models.DecimalField(decimal_places=2, max_digits=5)),
                ('target_irr_pct', models.DecimalField(decimal_places=2, max_digits=5)),
                ('pe_multiple', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('price_book_multiple', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('revenue_multiple', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('asset_sale_value', models.DecimalField(decimal_places=2, default=0, max_digits=20)),
                ('transaction_costs_pct', models.DecimalField(decimal_places=2, max_digits=5)),
                ('valuation_method', models.CharField(default='DCF', max_length=50)),
                ('target_equity_irr_pct', models.DecimalField(decimal_places=2, max_digits=5)),
                ('target_project_irr_pct', models.DecimalField(decimal_places=2, max_digits=5)),
                ('payback_period_target_years', models.IntegerField()),
                ('minimum_moic', models.DecimalField(decimal_places=2, max_digits=5)),
                ('scenario', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='exit_valuation', to='model.scenario')),
            ],
        ),
        migrations.CreateModel(
            name='DividendPolicy',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('dividend_payout_ratio_pct', models.DecimalField(decimal_places=2, max_digits=5)),
                ('dividend_payment_frequency', models.CharField(default='Annually', max_length=20)),
                ('minimum_cash_before_dividend', models.DecimalField(decimal_places=2, max_digits=20)),
                ('minimum_dscr_for_dividend', models.DecimalField(decimal_places=2, default=1.3, max_digits=5)),
                ('minimum_llcr_for_dividend', models.DecimalField(decimal_places=2, default=1.5, max_digits=5)),
                ('preferred_dividend_rate_pct', models.DecimalField(decimal_places=2, default=0, max_digits=5)),
                ('share_buyback_provision', models.BooleanField(default=False)),
                ('dividend_wht_pct', models.DecimalField(decimal_places=2, max_digits=5)),
                ('dividend_reinvestment_option', models.BooleanField(default=False)),
                ('scenario', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='dividend_policy', to='model.scenario')),
            ],
        ),
        migrations.CreateModel(
            name='DepreciationSchedule',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('asset_category', models.CharField(choices=[('land', 'Land & Land Improvements'), ('buildings', 'Buildings & Structures'), ('equipment', 'Plant, Equipment & Machinery'), ('ffe', 'Furniture, Fixtures & Equipment'), ('vehicles_it', 'Vehicles & IT Equipment')], max_length=50)),
                ('depreciation_method', models.CharField(choices=[('straight_line', 'Straight Line'), ('declining_balance', 'Declining Balance'), ('units_of_production', 'Units of Production'), ('sum_of_years', 'Sum of Years Digits')], default='straight_line', max_length=50)),
                ('asset_value', models.DecimalField(decimal_places=2, max_digits=20)),
                ('useful_life_years', models.IntegerField()),
                ('residual_value_pct', models.DecimalField(decimal_places=2, max_digits=5)),
                ('scenario', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='depreciation_schedules', to='model.scenario')),
            ],
        ),
        migrations.CreateModel(
            name='DebtFinancing',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('equity_percentage', models.DecimalField(decimal_places=2, max_digits=5)),
                ('debt_percentage', models.DecimalField(decimal_places=2, max_digits=5)),
                ('offplan_presales_percentage', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('interest_rate_type', models.CharField(default='Floating', max_length=20)),
                ('base_rate_type', models.CharField(default='SOFR', max_length=20)),
                ('base_rate_value', models.DecimalField(decimal_places=2, max_digits=5)),
                ('interest_margin_spread', models.DecimalField(decimal_places=2, max_digits=5)),
                ('loan_tenor_years', models.IntegerField()),
                ('grace_period_months', models.IntegerField(default=0)),
                ('repayment_type', models.CharField(default='Amortizing', max_length=50)),
                ('dsra_requirement_months', models.IntegerField(default=6)),
                ('dsra_funding_source', models.CharField(default='Cash', max_length=20)),
                ('upfront_fees_pct', models.DecimalField(decimal_places=2, max_digits=5)),
                ('commitment_fee_pct', models.DecimalField(decimal_places=2, max_digits=5)),
                ('drawdown_linked_to', models.CharField(default='CAPEX Schedule', max_length=50)),
                ('drawdown_frequency', models.CharField(default='Quarterly', max_length=20)),
                ('scenario', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='debt_financing', to='model.scenario')),
            ],
        ),
        migrations.CreateModel(
            name='CapitalExpenditure',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('land_cost', models.DecimalField(decimal_places=2, max_digits=20)),
                ('construction_building_cost', models.DecimalField(decimal_places=2, max_digits=20)),
                ('equipment_machinery_cost', models.DecimalField(decimal_places=2, max_digits=20)),
                ('ffe_cost', models.DecimalField(decimal_places=2, max_digits=20)),
                ('carpark_cost', models.DecimalField(blank=True, decimal_places=2, max_digits=20, null=True)),
                ('amenities_cost', models.DecimalField(blank=True, decimal_places=2, max_digits=20, null=True)),
                ('apartment_construction_cost', models.DecimalField(blank=True, decimal_places=2, max_digits=20, null=True)),
                ('hotel_commercial_cost', models.DecimalField(blank=True, decimal_places=2, max_digits=20, null=True)),
                ('contingency_pct', models.DecimalField(decimal_places=2, max_digits=5)),
                ('professional_fees_pct', models.DecimalField(decimal_places=2, max_digits=5)),
                ('permits_approvals_pct', models.DecimalField(decimal_places=2, max_digits=5)),
                ('vat_on_construction_pct', models.DecimalField(decimal_places=2, max_digits=5)),
                ('capitalize_interest', models.BooleanField(default=True)),
                ('construction_loan_interest_rate', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('year_1_drawdown_pct', models.DecimalField(decimal_places=2, max_digits=5)),
                ('year_2_drawdown_pct', models.DecimalField(decimal_places=2, max_digits=5)),
                ('year_3_drawdown_pct', models.DecimalField(decimal_places=2, max_digits=5)),
                ('replacement_capex_pct_revenue', models.DecimalField(decimal_places=2, max_digits=5)),
                ('expansion_capex', models.DecimalField(decimal_places=2, default=0, max_digits=20)),
                ('scenario', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='capital_expenditure', to='model.scenario')),
            ],
        ),
        migrations.CreateModel(
            name='CalculationLog',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('running', 'Running'), ('success', 'Success'), ('failed', 'Failed')], default='pending', max_length=20)),
                ('started_at', models.DateTimeField(auto_now_add=True)),
                ('completed_at', models.DateTimeField(blank=True, null=True)),
                ('error_message', models.TextField(blank=True)),
                ('error_traceback', models.TextField(blank=True)),
                ('duration_seconds', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('scenario', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='calculation_logs', to='model.scenario')),
                ('triggered_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'ordering': ['-started_at'],
            },
        ),
        migrations.CreateModel(
            name='CalculatedStatement',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('statement_type', models.CharField(choices=[('is', 'Income Statement'), ('bs', 'Balance Sheet'), ('cfs', 'Cash Flow Statement'), ('ratio', 'Financial Ratios'), ('debt', 'Debt Schedule'), ('valuation', 'Valuation Metrics')], max_length=20)),
                ('line_item', models.CharField(max_length=100)),
                ('values_by_period', models.JSONField()),
                ('formula_used', models.TextField(blank=True)),
                ('calculated_at', models.DateTimeField(auto_now=True)),
                ('scenario', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='calculated_statements', to='model.scenario')),
            ],
        ),
        migrations.CreateModel(
            name='RevenueProduct',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('product_order', models.IntegerField(default=1)),
                ('product_name', models.CharField(max_length=255)),
                ('unit_of_measure', models.CharField(max_length=50)),
                ('year_1_sales_volume', models.DecimalField(blank=True, decimal_places=2, max_digits=20, null=True)),
                ('unit_price_year_1', models.DecimalField(blank=True, decimal_places=2, max_digits=20, null=True)),
                ('volume_growth_rate', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('price_escalation_rate', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('number_of_units', models.IntegerField(blank=True, null=True)),
                ('gba_gross_building_area', models.DecimalField(blank=True, decimal_places=2, max_digits=20, null=True)),
                ('lettable_area', models.DecimalField(blank=True, decimal_places=2, max_digits=20, null=True)),
                ('sale_price_per_unit', models.DecimalField(blank=True, decimal_places=2, max_digits=20, null=True)),
                ('receivables_days_dso', models.IntegerField(blank=True, null=True)),
                ('revenue_rampup_months', models.IntegerField(blank=True, null=True)),
                ('seasonal_adjustment_factor', models.DecimalField(decimal_places=2, default=1.0, max_digits=5)),
                ('sales_absorption_period_months', models.IntegerField(blank=True, null=True)),
                ('presales_offplan_percentage', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('market_share_target', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('scenario', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='revenue_products', to='model.scenario')),
            ],
            options={
                'ordering': ['product_order'],
                'unique_together': {('scenario', 'product_order')},
            },
        ),
        migrations.AddIndex(
            model_name='financialmodel',
            index=models.Index(fields=['owner', '-updated_at'], name='model_finan_owner_i_c69b71_idx'),
        ),
        migrations.AddIndex(
            model_name='financialmodel',
            index=models.Index(fields=['project_type'], name='model_finan_project_a77f13_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='depreciationschedule',
            unique_together={('scenario', 'asset_category')},
        ),
        migrations.AddIndex(
            model_name='calculatedstatement',
            index=models.Index(fields=['scenario', 'statement_type'], name='model_calcu_scenari_b1448e_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='calculatedstatement',
            unique_together={('scenario', 'statement_type', 'line_item')},
        ),
    ]
